<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BD TM MINI BOT</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-blue-900 to-purple-900 min-h-screen text-white flex flex-col items-center">

  <!-- Header -->
  <header class="w-full p-4 text-center bg-black bg-opacity-40 shadow-lg">
    <h1 class="text-3xl font-bold">ğŸ’ BD TM MINI BOT</h1>
    <p class="text-sm opacity-80">Earn by Watching Ads & Referring Friends</p>
  </header>

  <!-- Join Channel -->
  <div class="mt-6">
    <a href="https://t.me/ADS_EARNING_BD_TM_CHANNEL" target="_blank"
       class="px-6 py-3 bg-green-500 hover:bg-green-600 rounded-2xl shadow-lg font-semibold">
       ğŸ“¢ Join Channel
    </a>
  </div>

  <!-- Buttons Section -->
  <div class="grid grid-cols-2 gap-6 mt-10 w-11/12 max-w-lg">
    <button onclick="showAd()" class="p-6 bg-blue-600 hover:bg-blue-700 rounded-2xl shadow-lg">
      â–¶ View Ad
    </button>

    <button onclick="openWithdraw()" class="p-6 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-2xl shadow-lg">
      ğŸ’³ Withdraw
    </button>

    <button onclick="openHistory()" class="p-6 bg-purple-600 hover:bg-purple-700 rounded-2xl shadow-lg">
      ğŸ“œ History
    </button>

    <button onclick="copyRefer()" class="p-6 bg-pink-600 hover:bg-pink-700 rounded-2xl shadow-lg">
      ğŸ Refer
    </button>
  </div>

  <!-- Balance -->
  <div id="balanceBox" class="mt-10 text-lg font-semibold">
    Balance: <span id="balance">0.00</span> à§³
  </div>

  <!-- Withdraw Modal -->
  <div id="withdrawModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center">
    <div class="bg-white text-black rounded-2xl p-6 w-80">
      <h2 class="text-xl font-bold mb-4">Withdraw Request</h2>
      <input id="bkashNumber" type="text" placeholder="Bkash Number"
             class="w-full p-2 border rounded mb-3" />
      <input id="amount" type="number" placeholder="Amount (min 10)"
             class="w-full p-2 border rounded mb-3" />
      <p class="text-xs text-gray-600 mb-4">âš  Minimum Withdraw: 10à§³ (Bkash only)</p>
      <div class="flex justify-between">
        <button onclick="submitWithdraw()" class="px-4 py-2 bg-green-600 text-white rounded-lg">Submit</button>
        <button onclick="closeWithdraw()" class="px-4 py-2 bg-gray-500 text-white rounded-lg">Cancel</button>
      </div>
    </div>
  </div>

  <!-- History Modal -->
  <div id="historyModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center">
    <div class="bg-white text-black rounded-2xl p-6 w-96 max-h-[80vh] overflow-y-auto">
      <h2 class="text-xl font-bold mb-4">Withdraw History</h2>
      <ul id="historyList" class="space-y-2 text-sm"></ul>
      <div class="flex justify-center mt-4">
        <button onclick="closeHistory()" class="px-4 py-2 bg-gray-500 text-white rounded-lg">Close</button>
      </div>
    </div>
  </div>

  <script>
    let balance = 0;
    let history = JSON.parse(localStorage.getItem("history")) || [];
    const isAdmin = false; // ğŸ‘‰ à¦à¦¡à¦®à¦¿à¦¨ à¦¹à¦²à§‡ true à¦•à¦°à§‡ à¦¨à¦¿à¦¨

    // âœ… à¦†à¦ªà¦¨à¦¾à¦° Bot Token + Admin Chat ID
    const BOT_TOKEN = "8169503775:AAHFBx2dXbnXLZHje8MUzgsx5chWjxD9dKY";
    const ADMIN_CHAT_ID = "7691157254";

    // Ad Show (Demo only, 17s delay)
    function showAd() {
      let counter = 17;
      const interval = setInterval(() => {
        counter--;
        if (counter < 0) {
          clearInterval(interval);
          balance += 0.2;
          document.getElementById("balance").innerText = balance.toFixed(2);
          alert("âœ… Ad watched! +0.20 à§³ added.");
        }
      }, 1000);
    }

    // Unique Withdraw ID à¦œà§‡à¦¨à¦¾à¦°à§‡à¦Ÿ
    function generateWithdrawID() {
      return "WD-" + Date.now() + "-" + Math.floor(Math.random() * 1000);
    }

    // Telegram à¦à¦¡à¦®à¦¿à¦¨à¦•à§‡ Withdraw Request à¦ªà¦¾à¦ à¦¾à¦¨à§‹
    function sendToAdmin(req) {
      const text = `ğŸ“¢ New Withdraw Request\nğŸ†” ID: ${req.id}\nğŸ’³ Number: ${req.number}\nğŸ’° Amount: à§³${req.amount}\nâ° ${req.date}`;
      fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: ADMIN_CHAT_ID,
          text: text
        })
      });
    }

    // Withdraw Modal
    function openWithdraw() {
      document.getElementById("withdrawModal").classList.remove("hidden");
    }
    function closeWithdraw() {
      document.getElementById("withdrawModal").classList.add("hidden");
    }

    // Withdraw Submit (Min 10à§³)
    function submitWithdraw() {
      const number = document.getElementById("bkashNumber").value;
      const amount = parseFloat(document.getElementById("amount").value);

      if (!number || amount < 10 || amount > balance) {
        alert("âš  Invalid request. Min 10 & within balance.");
        return;
      }

      const request = {
        id: generateWithdrawID(),
        number,
        amount,
        status: "Pending",
        date: new Date().toLocaleString()
      };

      history.push(request);
      localStorage.setItem("history", JSON.stringify(history));
      renderHistory();
      closeWithdraw();

      // âœ… à¦à¦¡à¦®à¦¿à¦¨à¦•à§‡ à¦¨à§‹à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦¶à¦¨ à¦ªà¦¾à¦ à¦¾à¦¨à§‹
      sendToAdmin(request);

      alert("âœ… Withdraw request submitted. Waiting for admin approval.\nğŸ†” Request ID: " + request.id);
    }

    // History Render
    function renderHistory() {
      const list = document.getElementById("historyList");
      list.innerHTML = "";
      history.forEach((req, index) => {
        const li = document.createElement("li");
        li.className = "p-2 border rounded flex flex-col";

        let statusHtml = `<span class="font-semibold">${req.status}</span>`;
        if (isAdmin && req.status === "Pending") {
          statusHtml = `
            <button onclick="acceptWithdraw(${index})" class="px-2 py-1 bg-green-600 text-white rounded">Accept</button>
            <button onclick="rejectWithdraw(${index})" class="px-2 py-1 bg-red-600 text-white rounded">Reject</button>
          `;
        }

        li.innerHTML = `
          <div>ğŸ†” ${req.id}</div>
          <div>à§³${req.amount} to ${req.number}</div>
          <div class="text-sm text-gray-600">(${req.date})</div>
          <div>â†’ ${statusHtml}</div>
        `;
        list.appendChild(li);
      });
    }

    // Admin Accept
    function acceptWithdraw(index) {
      if (history[index].status === "Pending") {
        if (balance >= history[index].amount) {
          balance -= history[index].amount;
          document.getElementById("balance").innerText = balance.toFixed(2);
          history[index].status = "Paid";
          localStorage.setItem("history", JSON.stringify(history));
          renderHistory();
        } else {
          alert("âš  Insufficient balance!");
        }
      }
    }

    // Admin Reject
    function rejectWithdraw(index) {
      if (history[index].status === "Pending") {
        history[index].status = "Rejected";
        localStorage.setItem("history", JSON.stringify(history));
        renderHistory();
      }
    }

    // History Modal
    function openHistory() {
      document.getElementById("historyModal").classList.remove("hidden");
      renderHistory();
    }
    function closeHistory() {
      document.getElementById("historyModal").classList.add("hidden");
    }

    // Refer Copy
    function copyRefer() {
      const referLink = "https://t.me/BD_TM_MINI_BOT";
      navigator.clipboard.writeText(referLink).then(() => {
        alert("âœ… Refer link copied: " + referLink);
      });
    }
  </script>
</body>
  </html>
