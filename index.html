<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BD TM MINI BOT</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Monetag SDK -->
  <script src="//libtl.com/sdk.js" data-zone="9842278" data-sdk="show_9842278"></script>
</head>
<body class="bg-gradient-to-r from-blue-900 to-purple-900 min-h-screen text-white flex flex-col items-center">

  <!-- Header -->
  <header class="w-full p-4 text-center bg-black bg-opacity-40 shadow-lg">
    <h1 class="text-3xl font-bold">💎 BD TM MINI BOT</h1>
    <p class="text-sm opacity-80">Earn by Watching Ads & Referring Friends</p>
  </header>

  <!-- Join Channel -->
  <div class="mt-6">
    <a href="https://t.me/ADS_EARNING_BD_TM_CHANNEL" target="_blank"
       class="px-6 py-3 bg-green-500 hover:bg-green-600 rounded-2xl shadow-lg font-semibold">
       📢 Join Channel
    </a>
  </div>

  <!-- Buttons Section -->
  <div class="grid grid-cols-2 gap-6 mt-10 w-11/12 max-w-lg">

    <!-- View Ad -->
    <button onclick="showAd()" class="p-6 bg-blue-600 hover:bg-blue-700 rounded-2xl shadow-lg">
      ▶ View Ad
    </button>

    <!-- Withdraw -->
    <button onclick="openWithdraw()" class="p-6 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-2xl shadow-lg">
      💳 Withdraw
    </button>

    <!-- History -->
    <button onclick="openHistory()" class="p-6 bg-purple-600 hover:bg-purple-700 rounded-2xl shadow-lg">
      📜 History
    </button>

    <!-- Refer -->
    <button onclick="copyRefer()" class="p-6 bg-pink-600 hover:bg-pink-700 rounded-2xl shadow-lg">
      🎁 Refer
    </button>
  </div>

  <!-- Balance -->
  <div id="balanceBox" class="mt-10 text-lg font-semibold">
    Balance: <span id="balance">0.00</span> ৳
  </div>

  <!-- Withdraw Modal -->
  <div id="withdrawModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center">
    <div class="bg-white text-black rounded-2xl p-6 w-80">
      <h2 class="text-xl font-bold mb-4">Withdraw Request</h2>
      <input id="bkashNumber" type="text" placeholder="Bkash Number"
             class="w-full p-2 border rounded mb-3" />
      <input id="amount" type="number" placeholder="Amount (min 10)"
             class="w-full p-2 border rounded mb-3" />
      <div class="flex justify-between">
        <button onclick="submitWithdraw()" class="px-4 py-2 bg-green-600 text-white rounded-lg">Submit</button>
        <button onclick="closeWithdraw()" class="px-4 py-2 bg-gray-500 text-white rounded-lg">Cancel</button>
      </div>
    </div>
  </div>

  <!-- History Modal -->
  <div id="historyModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center">
    <div class="bg-white text-black rounded-2xl p-6 w-96 max-h-[80vh] overflow-y-auto">
      <h2 class="text-xl font-bold mb-4">Withdraw History</h2>
      <ul id="historyList" class="space-y-2 text-sm"></ul>
      <div class="flex justify-center mt-4">
        <button onclick="closeHistory()" class="px-4 py-2 bg-gray-500 text-white rounded-lg">Close</button>
      </div>
    </div>
  </div>

  <script>
    let balance = 0;

    // Monetag Ad Show + 17s delay
    function showAd() {
      if (typeof show_9842278 === "function") {
        show_9842278(); // Monetag Ad popup

        // Countdown 17 seconds
        let counter = 17;
        const interval = setInterval(() => {
          console.log("⏳ Ad watching... " + counter + "s left");
          counter--;
          if (counter < 0) {
            clearInterval(interval);
            balance += 0.2;
            document.getElementById("balance").innerText = balance.toFixed(2);
            alert("✅ Ad watched! +0.20 ৳ added.");
          }
        }, 1000);
      } else {
        alert("❌ Ad not loaded yet.");
      }
    }

    // Withdraw Modal
    function openWithdraw() {
      document.getElementById("withdrawModal").classList.remove("hidden");
    }
    function closeWithdraw() {
      document.getElementById("withdrawModal").classList.add("hidden");
    }
    function submitWithdraw() {
      const number = document.getElementById("bkashNumber").value;
      const amount = parseFloat(document.getElementById("amount").value);
      if (!number || amount < 10 || amount > balance) {
        alert("⚠ Invalid request. Min 10 & within balance.");
        return;
      }
      balance -= amount;
      document.getElementById("balance").innerText = balance.toFixed(2);

      // History add
      const li = document.createElement("li");
      li.innerText = `৳${amount} to ${number} → Pending`;
      document.getElementById("historyList").appendChild(li);

      closeWithdraw();
    }

    // History Modal
    function openHistory() {
      document.getElementById("historyModal").classList.remove("hidden");
    }
    function closeHistory() {
      document.getElementById("historyModal").classList.add("hidden");
    }

    // Refer System (copy to clipboard)
    function copyRefer() {
      const referLink = "https://t.me/BD_TM_MINI_BOT";
      navigator.clipboard.writeText(referLink).then(() => {
        alert("✅ Refer link copied: " + referLink);
      });
    }
  </script>
</body>
</html>